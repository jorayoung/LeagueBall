<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="logo.png" type="image/png">
    <title>LeagueBall</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: white;
        }

        .game-container {
            position: relative;
            width: 800px;
            height: 500px;
        }

        #gameCanvas {
            background: linear-gradient(#2c3e50, #4a6491);
            border: 5px solid #34495e;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        }

        .ui-overlay {
    position: absolute;
    top: -100px; /* –ü–æ–¥–Ω–∏–º–∞–µ–º –æ–≤–µ—Ä–ª–µ–π –≤—ã—à–µ –ø–æ–ª—è */
    left: 0;
    width: 100%;
    height: auto;
    pointer-events: none;
    z-index: 10;
}

.score {
    position: absolute;
    top: 20px;
    font-size: 48px;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
}

#redScore {
    left: 35%; /* –ù–µ–º–Ω–æ–≥–æ —Å–¥–≤–∏–≥–∞–µ–º –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è */
    color: #ff4757;
}

#blueScore {
    right: 35%; /* –ù–µ–º–Ω–æ–≥–æ —Å–¥–≤–∏–≥–∞–µ–º –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è */
    color: #3742fa;
}

.timer {
    position: absolute;
    top: 30px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 36px;
    font-weight: bold;
    background: rgba(0, 0, 0, 0.7);
    padding: 8px 20px;
    border-radius: 25px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
    border: 2px solid rgba(255, 255, 255, 0.2);
}

.goal-animation {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 72px;
    font-weight: bold;
    color: gold;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
    opacity: 0;
    pointer-events: none;
    animation: goalPulse 2s ease-out;
    z-index: 20;
}

        @keyframes goalPulse {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            40% { transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
        }

        .menu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .menu h1 {
            margin-bottom: 20px;
            color: #fdbb2d;
            text-shadow: 0 0 10px rgba(253, 187, 45, 0.5);
        }

        .team-select {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .team-btn {
            padding: 15px 30px;
            font-size: 18px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        #redTeam {
            background: linear-gradient(to bottom, #ff4757, #c23616);
            color: white;
        }

        #blueTeam {
            background: linear-gradient(to bottom, #3742fa, #192a56);
            color: white;
        }

        .team-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .controls {
            margin-top: 20px;
            font-size: 14px;
            color: #ddd;
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            display: none;
            backdrop-filter: blur(10px);
            border: 2px solid gold;
        }

        .game-over h2 {
            color: gold;
            margin-bottom: 20px;
        }

        .restart-btn {
            padding: 12px 25px;
            font-size: 16px;
            background: linear-gradient(to bottom, #00b894, #00806a);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–û–± –∏–≥—Ä–µ" */
.about-btn {
    margin-top: 20px;
    padding: 12px 24px;
    font-size: 16px;
    font-weight: bold;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    z-index: 20;
    pointer-events: auto;
    display: block;
    margin-left: auto;
    margin-right: auto;
}

.about-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
}

.about-btn:active {
    transform: translateY(0);
}

/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–û–± –∏–≥—Ä–µ" */
.about-modal {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 600px;
    max-height: 80vh;
    background: rgba(0, 0, 0, 0.95);
    border-radius: 15px;
    padding: 30px;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 0 50px rgba(0, 0, 0, 0.8);
    display: none;
    z-index: 100;
    overflow-y: auto;
    color: white;
}

.about-content {
    position: relative;
}

.close-btn {
    position: absolute;
    top: -20px;
    right: -10px;
    background: linear-gradient(135deg, #ff4757, #c23616);
    color: white;
    border: none;
    border-radius: 50%;
    width: 35px;
    height: 35px;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.close-btn:hover {
    background: linear-gradient(135deg, #c23616, #ff4757);
    transform: scale(1.1);
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.4);
}

.about-section {
    margin-bottom: 25px;
}

.about-section h2 {
    color: #fdbb2d;
    margin-bottom: 15px;
    text-shadow: 0 0 10px rgba(253, 187, 45, 0.5);
    border-bottom: 2px solid rgba(253, 187, 45, 0.3);
    padding-bottom: 5px;
}

.about-section p {
    line-height: 1.6;
    margin-bottom: 10px;
    color: #ddd;
}

.about-section ul {
    list-style: none;
    padding-left: 20px;
}

.about-section li {
    margin-bottom: 8px;
    position: relative;
}

.about-section li:before {
    content: "‚Ä¢";
    color: #fdbb2d;
    font-weight: bold;
    display: inline-block;
    width: 1em;
    margin-left: -1em;
}

.links {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 10px;
    flex-wrap: wrap;
}

.link-btn {
    padding: 10px 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    text-decoration: none;
    border-radius: 25px;
    transition: all 0.3s ease;
    display: inline-block;
    font-weight: bold;
    text-align: center;
    min-width: 120px;
}

.link-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
}

/* –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞ */
.overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(5px);
    display: none;
    z-index: 90;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    backdrop-filter: blur(5px);
}

.modal-content {
    background: linear-gradient(135deg, #1a2a6c, #b21f1f);
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    width: 500px;
    max-width: 90%;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    border: 2px solid gold;
}

.modal h2 {
    color: #fdbb2d;
    margin-bottom: 20px;
    text-shadow: 0 0 10px rgba(253, 187, 45, 0.5);
}

.team-name-input {
    width: 100%;
    padding: 15px;
    font-size: 18px;
    border: 2px solid #fdbb2d;
    border-radius: 10px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    text-align: center;
    margin-bottom: 20px;
}

.team-name-input:focus {
    outline: none;
    border-color: #ff6b6b;
    box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
}

.color-picker {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
    margin: 20px 0;
}

.color-option {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    border: 3px solid transparent;
    transition: all 0.3s ease;
    margin: 0 auto;
}

.color-option:hover {
    transform: scale(1.2);
    border-color: white;
}

.color-option.selected {
    border-color: gold;
    box-shadow: 0 0 15px gold;
}

.submit-btn {
    padding: 12px 30px;
    font-size: 18px;
    background: linear-gradient(to bottom, #00b894, #00806a);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 20px;
}

.submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Ç—É—Ä–Ω–∏—Ä–Ω—ã—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
.tournament-modal {
    text-align: center;
}

.tournament-matchup {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 30px;
    margin: 30px 0;
}

.tournament-team {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

.tournament-vs {
    font-size: 24px;
    font-weight: bold;
    color: #fdbb2d;
}

.team-logo {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background-size: cover;
    background-position: center;
    border: 3px solid gold;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
}

.team-name {
    font-weight: bold;
    font-size: 16px;
    color: white;
}
    </style>
</head>
<body>
    <div class="game-container">
        <canvas id="gameCanvas" width="800" height="500"></canvas>
        
        <div class="ui-overlay">
            <div id="redScore" class="score">0</div>
            <div id="blueScore" class="score">0</div>
            <div id="timer" class="timer">3:00</div>
            <div id="goalAnimation" class="goal-animation">–ì–û–û–û–õ!</div>
        </div>

        <div id="teamMenu" class="menu">
            <h1>LeagueBall</h1>
            <p>–í—ã–±–µ—Ä–∏ —Å—Ç–æ—Ä–æ–Ω—É:</p>
            <div class="team-select">
                <button id="redTeam" class="team-btn">–°–ª–µ–≤–∞</button>
                <button id="blueTeam" class="team-btn">–°–ø—Ä–∞–≤–∞</button>
            </div>
<button id="aboutBtn" class="about-btn">–û–± –∏–≥—Ä–µ</button>
<div id="aboutModal" class="about-modal">
    <div class="about-content">
        <button class="close-btn">&times;</button>
        
        <div class="about-section">
            <h2>üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h2>
            <ul>
                <li><strong>WASD</strong> - –¥–≤–∏–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞</li>
                <li><strong>–ü–†–û–ë–ï–õ</strong> - —É–¥–∞—Ä –ø–æ –º—è—á—É</li>
                <li><strong>Q</strong> - –ø–æ–ø—Ä–æ—Å–∏—Ç—å –ø–∞—Å</li>
            </ul>
        </div>

        <div class="about-section">
            <h2>üèÜ –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
            <p>–ó–∞–±–µ–π—Ç–µ –±–æ–ª—å—à–µ –≥–æ–ª–æ–≤, —á–µ–º –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ –∑–∞ 3 –º–∏–Ω—É—Ç—ã!</p>
            <p>–ü—Ä–∏ –Ω–∏—á—å–µ–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ–≤–µ—Ä—Ç–∞–π–º –¥–æ –ø–µ—Ä–≤–æ–≥–æ –≥–æ–ª–∞ (–∑–æ–ª–æ—Ç–æ–π –≥–æ–ª).</p>
        </div>

        <div class="about-section">
            <h2>üí° –°–æ–≤–µ—Ç—ã</h2>
<ul>
        <li><strong>–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º</strong> - –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è –Ω–∞–∂–º–∏—Ç–µ F11</li>
        <li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</strong> - —Ä–µ–≥—É–ª–∏—Ä—É–π—Ç–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ Ctrl + +/-</li>
        <li><strong>–ö–æ–º–∞–Ω–¥–Ω–∞—è –∏–≥—Ä–∞</strong> - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Q —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—ã–π –ø–∞—Å</li>
        <li><strong>–ò–≥—Ä–∞ –±–µ–∑ –º—è—á–∞</strong> - –∑–∞–Ω–∏–º–∞–π—Ç–µ –≤—ã–≥–æ–¥–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∏ –≤—ã–∑—ã–≤–∞–π—Ç–µ –ø–∞—Å –∫–æ–≥–¥–∞ —Å–≤–æ–±–æ–¥–Ω—ã</li>
        <li><strong>–û–±–æ—Ä–æ–Ω–∞</strong> - –ó–∞–Ω–∏–º–∞–π—Ç–µ –≤—ã–≥–æ–¥–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏, –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤ –∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–π—Ç–µ –ø–∞—Å—ã</li>
        <li><strong>–ü–æ–∑–∏—Ü–∏–æ–Ω–∫–∞</strong> - –í–æ–≤—Ä–µ–º—è –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ—Å—å –ø–æ–¥ –ø–∞—Å –µ—Å–ª–∏ —Å–æ—é–∑–Ω–∏–∫–∞ –ø—Ä–µ—Å–∏–Ω–≥—É—é—Ç</li>
        <li><strong>–í—ã–±–æ—Ä</strong> - –¢—ã –º–æ–∂–µ—à—å –±—ã—Ç—å —Ö–æ—Ç—å –≤—Ä–∞—Ç–∞—Ä—ë–º, —Ö–æ—Ç—å –æ–ø–æ—Ä–Ω–∏–∫–æ–º, —Ö–æ—Ç—å –Ω–∞–ø–∞–¥–∞—é—â–∏–º, —Ç—ã —Å–∞–º —Ä–µ—à–∞–µ—à—å —Å –∫–∞–∫–∏–º —Ç–µ–º–ø–æ–º –±—É–¥–µ—Ç –∏–¥—Ç–∏ –∏–≥—Ä–∞</li>
</ul>
        </div>

        <div class="about-section">
            <h2>üîó –°—Å—ã–ª–∫–∏</h2>
            <div class="links">
                <a href="https://github.com/jorayoung" class="link-btn">GitHub</a>
                <a href="https://www.youtube.com/channel/UC8-FsZ4oaW4k0Tlydl54lmg/featured" class="link-btn">YouTube</a>
                <a href="https://t.me/NoStuff_haxball" class="link-btn">–¢–µ–ª–µ–≥—Ä–∞–º –∫–∞–Ω–∞–ª</a>
                <a href="https://t.me/jorayoung761" class="link-btn">–¢–µ–ª–µ–≥—Ä–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</a>
                <a href="https://vk.com/coraline161" class="link-btn">–í–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</a>
            </div>
        </div>

        <div class="about-section">
            <h2>‚ÑπÔ∏è –û –ø—Ä–æ–µ–∫—Ç–µ</h2>
            <p>LeagueBall - —Ñ—É—Ç–±–æ–ª—å–Ω—ã–π –∞—Ä–∫–∞–¥–Ω—ã–π —Å–∏–º—É–ª—è—Ç–æ—Ä, –ø–æ–≥—Ä—É–∑–∏—Å—å –≤ –∫–æ–º–∞–Ω–¥–Ω—É—é –∏–≥—Ä—É —Å –ò–ò –∏–≥—Ä–æ–∫–∞–º–∏, —Å—Ç–∞–Ω—å –≥–ª–∞–≤–Ω–æ–π —Å–µ–Ω—Å–∞—Ü–∏–µ–π —Ç—É—Ä–Ω–∏—Ä–∞.</p>
            <p>–í–µ—Ä—Å–∏—è: 1.0 | –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: Jora young</p>
        </div>
    </div>
</div>
<div id="overlay" class="overlay"></div>
        </div>

        <div id="gameOver" class="game-over">
            <h2>–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!</h2>
            <p>–§–∏–Ω–∞–ª—å–Ω—ã–π —Å—á–µ—Ç: <span id="finalScore">0 - 0</span></p>
            <button id="restartBtn" class="restart-btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>


<!-- –ó–≤—É–∫–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
<audio id="kickSound" src="kick.mp3" preload="auto"></audio>
<audio id="goalSound" src="goal.mp3" preload="auto"></audio>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã -->
<div id="teamNameModal" class="modal" style="display: flex;">
    <div class="modal-content">
        <h2>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã</h2>
        <input type="text" id="teamNameInput" class="team-name-input" placeholder="–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ —á–µ–º–ø–∏–æ–Ω—ã" maxlength="20">
        <button id="teamNameSubmit" class="submit-btn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–∞ -->
<div id="colorModal" class="modal" style="display: none;">
    <div class="modal-content">
        <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã</h2>
        <div class="color-picker">
            <div class="color-option" data-color="#ff4757" style="background: #ff4757;"></div>
            <div class="color-option" data-color="#3742fa" style="background: #3742fa;"></div>
            <div class="color-option" data-color="#000000" style="background: #000000;"></div>
            <div class="color-option" data-color="#ffa502" style="background: #ffa502;"></div>
            <div class="color-option" data-color="#a55eea" style="background: #a55eea;"></div>
            <div class="color-option" data-color="#fd79a8" style="background: #fd79a8;"></div>
            <div class="color-option" data-color="#fdcb6e" style="background: #fdcb6e;"></div>
            <div class="color-option" data-color="#00cec9" style="background: #00cec9;"></div>
            <div class="color-option" data-color="#6c5ce7" style="background: #6c5ce7;"></div>
            <div class="color-option" data-color="#dfe6e9" style="background: #dfe6e9;"></div>
            <div class="color-option" data-color="#e17055" style="background: #e17055;"></div>
            <div class="color-option" data-color="#0984e3" style="background: #0984e3;"></div>
            <div class="color-option" data-color="#b2bec3" style="background: #b2bec3;"></div>
            <div class="color-option" data-color="#00d2d3" style="background: #00d2d3;"></div>
            <div class="color-option" data-color="#5f27cd" style="background: #5f27cd;"></div>
        </div>
        <button id="colorSubmit" class="submit-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
    </div>
</div>
    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
        const config = {
            width: 800,
            height: 500,
            playerRadius: 13,
            ballRadius: 8,
            goalWidth: 100,
            goalHeight: 150,
            playerSpeed: 4.0,
            kickPower: 8,
            friction: 0.98,
            ballFriction: 0.99,
            ballAfkThreshold: 3000,
            playerBallInteraction: 0.3, // –£–º–µ–Ω—å—à–µ–Ω–æ –¥–ª—è –±–æ–ª–µ–µ –ø–ª–∞–≤–Ω–æ–≥–æ –≤–µ–¥–µ–Ω–∏—è
            ballControlDistance: 25, // –î–∏—Å—Ç–∞–Ω—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è –º—è—á–∞
            goalCooldown: 150, // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ –≥–æ–ª–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≥–æ–ª–æ–≤
            ballLastMoveTime: 0,
	    ballLastX: 0,
            ballLastY: 0,
        };


const botConfig = {
    speed: 3.9,
    reactionTime: 0.8,
    kickPower: 8,
    ballControl: 0.4, // –°–∏–ª–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –º—è—á–∞ –¥–ª—è –±–æ—Ç–æ–≤
    positioning: {
        goalkeeper: { x: 100, y: config.height / 2 },
        defender: { x: config.width / 3, y: config.height / 2 },
        attacker: { x: config.width * 2 / 3, y: config.height / 2 }
    }
};

// –ë–æ—Ç—ã
let redBots = [];
let blueBots = [];

// –î–∞–Ω–Ω—ã–µ —Ç—É—Ä–Ω–∏—Ä–∞
const tournamentData = {
    stages: [
        {
            name: "1/16 —Ñ–∏–Ω–∞–ª–∞",
            teams: [
                { name: "–†–æ—Å—Ç–æ–≤", logo: "rostov.png", colors: ["#e2d512", "#09224e"] },
                { name: "–ó–µ–Ω–∏—Ç", logo: "zenit.png", colors: ["#00A9E0", "#004C97"] },
                { name: "–°–∞–Ω—Ç–æ—Å", logo: "santos.png", colors: ["#000000", "#FFFFFF"] },
                { name: "–î–∏–Ω–∞–º–æ", logo: "dinamo.png", colors: ["#FFFFFF", "#005BBB"] },
                { name: "–¶–°–ö–ê", logo: "cska.png", colors: ["#BD0000", "#2300BD"] },
                { name: "–§–µ–Ω–µ—Ä–±–∞—Ö—á–µ", logo: "fener.png", colors: ["#EDF500", "#2300BD"] },
                { name: "–ë–µ—à–∏–∫—Ç–∞—à", logo: "besiktash.png", colors: ["#000000", "#FFFFFF"] },
                { name: "–°–µ–ª—Ç–∏–∫", logo: "seltic.png", colors: ["#006437", "#FFFFFF"] },
                { name: "–ë—Ä—é–≥–≥–µ", logo: "brugge.png", colors: ["#004994", "#000000"] },
                { name: "–ê–π–Ω—Ç—Ä–∞—Ö—Ç", logo: "antraht.png", colors: ["#000000", "#FFFFFF"] },
                { name: "–°–ø–∞—Ä—Ç–∞–∫", logo: "spartak.png", colors: ["#DC052D", "#FFFFFF"] },
                { name: "–õ–æ–∫–æ–º–æ—Ç–∏–≤", logo: "loko.png", colors: ["#005C18", "#AD0000"] },
                { name: "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä", logo: "krasnodar.png", colors: ["#005C18", "#002909"] },
                { name: "–†—É–±–∏–Ω", logo: "rubin.png", colors: ["#870000", "#290000"] },
                { name: "–®–∞—Ö—Ç—ë—Ä", logo: "shahter.png", colors: ["#FF6A00", "#000000"] },
                { name: "–î–∏–Ω–∞–º–æ –ú–∏–Ω—Å–∫", logo: "minsk.png", colors: ["#FFFFFF", "#85F5FF"] },
                { name: "–ö–∞–π—Ä–∞—Ç", logo: "kairat.png", colors: ["#F0FF00", "#000000"] },
                { name: "–ö–æ–º–æ", logo: "como.png", colors: ["#66E9FF", "#FFFFFF"] },
                { name: "–í–∞–ª—å—è–¥–æ–ª–∏–¥", logo: "valhadolid.png", colors: ["#9300BF", "#69008A"] },
                { name: "–†–µ–Ω–Ω", logo: "renn.png", colors: ["#C40000", "#000000"] },
                { name: "–•–æ—Ñ–µ–Ω—Ö–∞–π–º", logo: "hof.png", colors: ["#2E53FF", "#000000"] },
            ]
        },
        {
            name: "1/8 —Ñ–∏–Ω–∞–ª–∞",
            teams: [
                { name: "–°–ø–æ—Ä—Ç–∏–Ω–≥", logo: "sporting.png", colors: ["#006437", "#FFFFFF"] },
                { name: "–ê—è–∫—Å", logo: "ajax.png", colors: ["#D2122E", "#FFFFFF"] },
                { name: "–ë–æ—Ä—É—Å—Å–∏—è –î–æ—Ä—Ç–º—É–Ω–¥", logo: "dortmund.png", colors: ["#FDE100", "#000000"] },
                { name: "–ü–æ—Ä—Ç—É", logo: "portu.png", colors: ["#FFFFFF", "#005BBB"] },
                { name: "–§–∏–æ—Ä–µ–Ω—Ç–∏–Ω–∞", logo: "fiorentina.png", colors: ["#6700B8", "#3E0070"] },
                { name: "–õ–∞—Ü–∏–æ", logo: "lazio.png", colors: ["#66C2FF", "#A6DCFF"] },
                { name: "–ì–∞–ª–∞—Ç–∞—Å–∞—Ä–∞–π", logo: "galo.png", colors: ["#DB9900", "#7D0300"] },
            ]
        },
        {
            name: "1/4 —Ñ–∏–Ω–∞–ª–∞",
            teams: [
                { name: "–ë–∞–≤–∞—Ä–∏—è", logo: "bayern.png", colors: ["#DC052D", "#FFFFFF"] },
                { name: "–ê—Ä—Å–µ–Ω–∞–ª", logo: "arsenal.png", colors: ["#EF0107", "#FFFFFF"] },
                { name: "–ù—å—é–∫–∞—Å–ª –Æ–Ω–∞–π—Ç–µ–¥", logo: "newcastle.png", colors: ["#241F20", "#FFFFFF"] },
                { name: "–¢–æ—Ç—Ç–µ–Ω—Ö–µ–º", logo: "tottenham.png", colors: ["#FFFFFF", "#000026"] },
                { name: "–ù–∞–ø–æ–ª–∏", logo: "napoli.png", colors: ["#089DFF", "#007ECF"] },
                { name: "–ê—Ç–∞–ª–∞–Ω—Ç–∞", logo: "atalanta.png", colors: ["#0000B3", "#000000"] },
                { name: "–ú–∏–ª–∞–Ω", logo: "milan.png", colors: ["#B30000", "#000000"] },
            ]
        },
        {
            name: "1/2 —Ñ–∏–Ω–∞–ª–∞",
            teams: [
                { name: "–ê—Ç–ª–µ—Ç–∏–∫–æ –ú–∞–¥—Ä–∏–¥", logo: "atletico.png", colors: ["#CB3524", "#0C2340"] },
                { name: "–ß–µ–ª—Å–∏", logo: "chelsea.png", colors: ["#034694", "#FFFFFF"] },
                { name: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –Æ–Ω–∞–π—Ç–µ–¥", logo: "manutd.png", colors: ["#DA291C", "#e10505"] },
                { name: "–ú–∞–Ω—á–µ—Å—Ç–µ—Ä –°–∏—Ç–∏", logo: "manc.png", colors: ["#8ADAFF", "#D9F4FF"] },
                { name: "–ò–Ω—Ç–µ—Ä", logo: "inter.png", colors: ["#004994", "#000000"] },
            ]
        },
        {
            name: "–§–∏–Ω–∞–ª",
            teams: [
                { name: "–†–µ–∞–ª –ú–∞–¥—Ä–∏–¥", logo: "realmadrid.png", colors: ["#FFFFFF", "#000000"] },
                { name: "–õ–∏–≤–µ—Ä–ø—É–ª—å", logo: "liverpool.png", colors: ["#C8102E", "#FFFFFF"] },
                { name: "–ë–∞—Ä—Å–µ–ª–æ–Ω–∞", logo: "barcelona.png", colors: ["#A50044", "#004D98"] },
                { name: "–ü–°–ñ", logo: "psg.png", colors: ["#001345", "#BA0000"] },
            ]
        }
    ]
};

// –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ —Ç—É—Ä–Ω–∏—Ä–∞
const difficultyLevels = {
    0: { // 1/16 —Ñ–∏–Ω–∞–ª–∞ - –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å (–∫–∞–∫ —Å–µ–π—á–∞—Å)
        speedMultiplier: 1.0,
        kickPowerMultiplier: 1.0,
        reactionMultiplier: 1.0,
        errorChance: 0.4, // 40% —à–∞–Ω—Å –æ—à–∏–±–∫–∏
        passAccuracy: 0.6 // 60% —Ç–æ—á–Ω–æ—Å—Ç—å –ø–∞—Å–æ–≤
    },
    1: { // 1/8 —Ñ–∏–Ω–∞–ª–∞ - –Ω–∞ 15% –ª—É—á—à–µ
        speedMultiplier: 1.15,
        kickPowerMultiplier: 1.15,
        reactionMultiplier: 1.15,
        errorChance: 0.3,
        passAccuracy: 0.7
    },
    2: { // 1/4 —Ñ–∏–Ω–∞–ª–∞ - –µ—â–µ –ª—É—á—à–µ
        speedMultiplier: 1.25,
        kickPowerMultiplier: 1.25,
        reactionMultiplier: 1.3,
        errorChance: 0.2,
        passAccuracy: 0.8
    },
    3: { // 1/2 —Ñ–∏–Ω–∞–ª–∞ - –ø–æ—á—Ç–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—ã
        speedMultiplier: 1.4,
        kickPowerMultiplier: 1.4,
        reactionMultiplier: 1.7,
        errorChance: 0.1,
        passAccuracy: 0.9
    },
    4: { // –§–∏–Ω–∞–ª - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å
        speedMultiplier: 1.6,
        kickPowerMultiplier: 1.6,
        reactionMultiplier: 2.0,
        errorChance: 0.01, // –ø–æ—á—Ç–∏ –Ω–µ –æ—à–∏–±–∞—é—Ç—Å—è
        passAccuracy: 0.99 // —Ç–æ—á–Ω—ã–µ –ø–∞—Å—ã
    }
};


        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            running: false,
            redScore: 0,
            blueScore: 0,
            timeLeft: 180,
            playerTeam: 'red',
            goalAnimation: false,
            animationTimer: 0,
            goalJustScored: false, // –§–ª–∞–≥, —á—Ç–æ –≥–æ–ª —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–±–∏—Ç
            goalCooldown: 0, // –¢–∞–π–º–µ—Ä –∑–∞–¥–µ—Ä–∂–∫–∏ –ø–æ—Å–ª–µ –≥–æ–ª–∞
            isOvertime: false,
            isGoldenGoal: false,
            overtimeStarted: false,
tournament: {
        active: false,
        currentStage: 0,
        playerTeam: null,
        opponentTeam: null,
        stageCompleted: false
    }
        };

        // –ò–≥—Ä–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
        let player = {
            x: config.width / 2,
            y: config.height / 2,
            vx: 0,
            vy: 0,
            kicking: false,
            kickCooldown: 0,
            hasBall: false // –§–ª–∞–≥, —á—Ç–æ –∏–≥—Ä–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –º—è—á
        };



        let ball = {
            x: config.width / 2,
            y: config.height / 2,
            vx: 0,
            vy: 0
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const redScoreElem = document.getElementById('redScore');
        const blueScoreElem = document.getElementById('blueScore');
        const timerElem = document.getElementById('timer');
        const goalAnimationElem = document.getElementById('goalAnimation');
        const teamMenu = document.getElementById('teamMenu');
        const gameOverElem = document.getElementById('gameOver');
        const finalScoreElem = document.getElementById('finalScore');
        const restartBtn = document.getElementById('restartBtn');

        // –ö–ª–∞–≤–∏—à–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        const keys = {
            w: false,
            a: false,
            s: false,
            d: false,
            space: false,
            q: false
        };

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('keydown', (e) => {
            const key = e.code.toLowerCase();
            if (key === 'keyw') keys.w = true;
            if (key === 'keya') keys.a = true;
            if (key === 'keys') keys.s = true;
            if (key === 'keyd') keys.d = true;
            if (key === 'space') keys.space = true;
            if (key === 'keyq') keys.q = true;
        });

        document.addEventListener('keyup', (e) => {
            const key = e.code.toLowerCase();
            if (key === 'keyw') keys.w = false;
            if (key === 'keya') keys.a = false;
            if (key === 'keys') keys.s = false;
            if (key === 'keyd') keys.d = false;
            if (key === 'space') keys.space = false;
            if (key === 'keyq') keys.q = false;
        });

// –í—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã
document.getElementById('redTeam').addEventListener('click', () => {
    gameState.playerTeam = 'red';
    startTournament(); // –ó–∞–º–µ–Ω—è–µ–º startGame() –Ω–∞ startTournament()
});

document.getElementById('blueTeam').addEventListener('click', () => {
    gameState.playerTeam = 'blue';
    startTournament(); // –ó–∞–º–µ–Ω—è–µ–º startGame() –Ω–∞ startTournament()
});

        // –†–µ—Å—Ç–∞—Ä—Ç –∏–≥—Ä—ã
        restartBtn.addEventListener('click', () => {
            gameOverElem.style.display = 'none';
            teamMenu.style.display = 'block';
            resetGame();
        });

        function startGame() {
    teamMenu.style.display = 'none';
    gameState.running = true;
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã –¥–ª—è –Ω–æ–≤–æ–≥–æ –º–∞—Ç—á–∞
    gameState.redScore = 0;
    gameState.blueScore = 0;
    gameState.timeLeft = 180;
    gameState.isOvertime = false;
    gameState.isGoldenGoal = false;
    gameState.overtimeStarted = false;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º UI
    redScoreElem.textContent = '0';
    blueScoreElem.textContent = '0';
    timerElem.textContent = '3:00';
    timerElem.style.display = 'block';
    
    // –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å "–î–û –ó–ì" –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
    if (document.getElementById('goldenGoalText')) {
        document.getElementById('goldenGoalText').style.display = 'none';
    }
    
    resetPositions();
    initBots();
    gameLoop();
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ç—É—Ä–Ω–∏—Ä–∞
function startTournament() {
    gameState.tournament.active = true;
    gameState.tournament.currentStage = 0;
    gameState.tournament.stageCompleted = false;
    selectRandomOpponent();
    showTournamentModal();
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞
function selectRandomOpponent() {
    const currentStage = tournamentData.stages[gameState.tournament.currentStage];
    const randomIndex = Math.floor(Math.random() * currentStage.teams.length);
    gameState.tournament.opponentTeam = currentStage.teams[randomIndex];
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
function getCurrentDifficulty() {
    const stageIndex = gameState.tournament.currentStage;
    return difficultyLevels[stageIndex] || difficultyLevels[0];
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∏–≥—Ä–æ–∫–æ–≤ —Å –¥–≤—É—Ö—Ü–≤–µ—Ç–Ω–æ–π —Ñ–æ—Ä–º–æ–π
function drawTwoColorPlayer(x, y, radius, topColor, bottomColor) {
    // –í–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ–≤–∏–Ω–∞
    ctx.fillStyle = topColor;
    ctx.beginPath();
    ctx.arc(x, y, radius, Math.PI, 0, false);
    ctx.fill();
    
    // –ù–∏–∂–Ω—è—è –ø–æ–ª–æ–≤–∏–Ω–∞
    ctx.fillStyle = bottomColor;
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, Math.PI, false);
    ctx.fill();
    
    // –û–±–≤–æ–¥–∫–∞
    ctx.strokeStyle = '#ffffff';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, Math.PI * 2);
    ctx.stroke();
}


// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ç—É—Ä–Ω–∏—Ä–∞
function showTournamentModal() {
    const stage = tournamentData.stages[gameState.tournament.currentStage];
    const opponentColors = gameState.tournament.opponentTeam.colors;
    const difficulty = getCurrentDifficulty();
    
    // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç—É—Ä–Ω–∏—Ä–∞
    const tournamentModal = document.createElement('div');
    tournamentModal.className = 'modal';
    tournamentModal.innerHTML = `
        <div class="modal-content tournament-modal">
            <h2>${stage.name}</h2>
            <div class="tournament-matchup">
                <div class="tournament-team">
                    <div class="team-logo" style="background: linear-gradient(to bottom, ${teamColor}, ${teamColor})"></div>
                    <div class="team-name">${teamName}</div>
                    <div style="font-size: 12px; color: #00ff00;">‚òÖ –£—Ä–æ–≤–µ–Ω—å 1</div>
                </div>
                <div class="tournament-vs">VS</div>
                <div class="tournament-team">
                    <div class="team-logo" style="background: linear-gradient(to bottom, ${opponentColors[0]}, ${opponentColors[1]})"></div>
                    <div class="team-name">${gameState.tournament.opponentTeam.name}</div>
                    <div style="font-size: 12px; color: #ff6b6b;">‚òÖ –£—Ä–æ–≤–µ–Ω—å ${gameState.tournament.currentStage + 1}</div>
                </div>
            </div>
            <div style="margin: 15px 0; color: #fdbb2d; font-weight: bold;">
                –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: ${gameState.tournament.currentStage + 1}/5
            </div>
            <div style="margin: 10px 0; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 8px;">
                <div style="font-size: 12px; color: #ddd; margin-bottom: 5px;">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞:</div>
                <div style="font-size: 11px; color: #ff6b6b;">‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: +${Math.round((difficulty.speedMultiplier - 1) * 100)}%</div>
                <div style="font-size: 11px; color: #ff9ff3;">üí• –°–∏–ª–∞ —É–¥–∞—Ä–∞: +${Math.round((difficulty.kickPowerMultiplier - 1) * 100)}%</div>
                <div style="font-size: 11px; color: #feca57;">üéØ –¢–æ—á–Ω–æ—Å—Ç—å: ${Math.round(difficulty.passAccuracy * 100)}%</div>
                <div style="font-size: 11px; color: #00ff00;">‚úÖ –í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞: –£—Ä–æ–≤–µ–Ω—å 1</div>
            </div>
            <button id="tournamentPlayBtn" class="submit-btn">–ò–≥—Ä–∞—Ç—å</button>
        </div>
    `;
    
    document.body.appendChild(tournamentModal);
    
    // –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    console.log(`–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —ç—Ç–∞–ø: ${stage.name}`);
    console.log(`–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤: –≠—Ç–∞–ø ${gameState.tournament.currentStage + 1}`);
    console.log(`- –°–∫–æ—Ä–æ—Å—Ç—å —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤: x${difficulty.speedMultiplier}`);
    console.log(`- –°–∏–ª–∞ —É–¥–∞—Ä–∞ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤: x${difficulty.kickPowerMultiplier}`);
    console.log(`- –†–µ–∞–∫—Ü–∏—è —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤: x${difficulty.reactionMultiplier}`);
    console.log(`- –®–∞–Ω—Å –æ—à–∏–±–∫–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤: ${difficulty.errorChance * 100}%`);
    console.log(`- –¢–æ—á–Ω–æ—Å—Ç—å –ø–∞—Å–æ–≤ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤: ${difficulty.passAccuracy * 100}%`);
    console.log(`- –í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞: –±–∞–∑–æ–≤–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å`);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ò–≥—Ä–∞—Ç—å"
    document.getElementById('tournamentPlayBtn').addEventListener('click', () => {
        document.body.removeChild(tournamentModal);
        startGame();
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –º–∞—Ç—á–∞
function handleMatchResult(isWin) {
    if (!gameState.tournament.active) return;
    
    if (isWin) {
        // –ò–≥—Ä–æ–∫ –ø–æ–±–µ–¥–∏–ª - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø
        gameState.tournament.currentStage++;
        
        if (gameState.tournament.currentStage >= tournamentData.stages.length) {
            // –¢—É—Ä–Ω–∏—Ä –ø—Ä–æ–π–¥–µ–Ω!
            showTournamentWinModal();
            gameState.tournament.active = false;
        } else {
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø
            gameState.tournament.stageCompleted = true;
            selectRandomOpponent();
            
            // –ü–ï–†–ï–°–û–ó–î–ê–ï–ú –ë–û–¢–û–í –° –ù–û–í–´–ú –£–†–û–í–ù–ï–ú –°–õ–û–ñ–ù–û–°–¢–ò
            initBots();
            
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            setTimeout(() => {
                showTournamentModal();
            }, 1000);
        }
    } else {
        // –ò–≥—Ä–æ–∫ –ø—Ä–æ–∏–≥—Ä–∞–ª - –≤—ã–ª–µ—Ç –∏–∑ —Ç—É—Ä–Ω–∏—Ä–∞
        showTournamentLossModal();
        gameState.tournament.active = false;
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –±–æ—Ç–æ–≤ –∫ –±–∞–∑–æ–≤–æ–º—É —É—Ä–æ–≤–Ω—é —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–ª—É—á–∞–π –Ω–æ–≤–æ–π –∏–≥—Ä—ã
        setTimeout(() => {
            initBots();
        }, 1000);
    }
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥–∏ –æ–≤–µ—Ä—Ç–∞–π–º–∞
    gameState.isOvertime = false;
    gameState.isGoldenGoal = false;
    gameState.overtimeStarted = false;
    
    // –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å "–î–û –ó–ì" –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
    if (document.getElementById('goldenGoalText')) {
        document.getElementById('goldenGoalText').style.display = 'none';
    }
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–∞—Ç—á–∞
    timerElem.style.display = 'block';
    
    // –õ–æ–≥–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    const stageName = tournamentData.stages[gameState.tournament.currentStage - (isWin ? 0 : 1)]?.name || "–ó–∞–≤–µ—Ä—à–µ–Ω";
    console.log(`–ú–∞—Ç—á ${isWin ? '–≤—ã–∏–≥—Ä–∞–Ω' : '–ø—Ä–æ–∏–≥—Ä–∞–Ω'} –Ω–∞ —ç—Ç–∞–ø–µ: ${stageName}`);
    console.log(`–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: ${gameState.tournament.currentStage}/5`);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –æ–∫–Ω–∞ –ø–æ–±–µ–¥—ã –≤ —Ç—É—Ä–Ω–∏—Ä–µ
function showTournamentWinModal() {
    const winModal = document.createElement('div');
    winModal.className = 'modal';
    winModal.innerHTML = `
        <div class="modal-content">
            <h2>üèÜ –ü–û–ë–ï–î–ê –í –¢–£–†–ù–ò–†–ï!</h2>
            <p>–í—ã —Å—Ç–∞–ª–∏ —á–µ–º–ø–∏–æ–Ω–æ–º —Ç—É—Ä–Ω–∏—Ä–∞!</p>
            <button id="tournamentRestartBtn" class="submit-btn">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
        </div>
    `;
    
    document.body.appendChild(winModal);
    
    document.getElementById('tournamentRestartBtn').addEventListener('click', () => {
        document.body.removeChild(winModal);
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
function logDifficultyLevel() {
    const difficulty = getCurrentDifficulty();
    console.log(`–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –≠—Ç–∞–ø ${gameState.tournament.currentStage + 1}`);
    console.log(`- –°–∫–æ—Ä–æ—Å—Ç—å: x${difficulty.speedMultiplier}`);
    console.log(`- –°–∏–ª–∞ —É–¥–∞—Ä–∞: x${difficulty.kickPowerMultiplier}`);
    console.log(`- –†–µ–∞–∫—Ü–∏—è: x${difficulty.reactionMultiplier}`);
    console.log(`- –®–∞–Ω—Å –æ—à–∏–±–∫–∏: ${difficulty.errorChance * 100}%`);
    console.log(`- –¢–æ—á–Ω–æ—Å—Ç—å –ø–∞—Å–æ–≤: ${difficulty.passAccuracy * 100}%`);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –æ–∫–Ω–∞ –ø—Ä–æ–∏–≥—Ä—ã—à–∞ –≤ —Ç—É—Ä–Ω–∏—Ä–µ
function showTournamentLossModal() {
    const lossModal = document.createElement('div');
    lossModal.className = 'modal';
    lossModal.innerHTML = `
        <div class="modal-content">
            <h2>üòî –í–´–õ–ï–¢ –ò–ó –¢–£–†–ù–ò–†–ê</h2>
            <p>–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ –≤ ${tournamentData.stages[gameState.tournament.currentStage].name}</p>
            <button id="tournamentLossBtn" class="submit-btn">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
        </div>
    `;
    
    document.body.appendChild(lossModal);
    
    document.getElementById('tournamentLossBtn').addEventListener('click', () => {
        document.body.removeChild(lossModal);
    });
}

        function resetGame() {
    gameState = {
        running: false,
        redScore: 0,
        blueScore: 0,
        timeLeft: 180,
        playerTeam: 'red',
        goalAnimation: false,
        animationTimer: 0,
        goalJustScored: false,
        goalCooldown: 0,
        isOvertime: false,
        isGoldenGoal: false,
        overtimeStarted: false,
        tournament: {
            active: false,
            currentStage: 0,
            playerTeam: null,
            opponentTeam: null,
            stageCompleted: false
        }
    };
    redScoreElem.textContent = '0';
    blueScoreElem.textContent = '0';
    timerElem.textContent = '3:00';
    timerElem.style.display = 'block';
    
    // –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å "–î–û –ó–ì" –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
    if (document.getElementById('goldenGoalText')) {
        document.getElementById('goldenGoalText').style.display = 'none';
    }
}

// –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥—ã
let teamName = '';
let teamColor = '';

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∫–æ–º–∞–Ω–¥—ã
function showTeamNameModal() {
    const modal = document.getElementById('teamNameModal');
    modal.style.display = 'flex';
    
    // –§–æ–∫—É—Å –Ω–∞ input –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
    setTimeout(() => {
        document.getElementById('teamNameInput').focus();
    }, 100);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –≤—ã–±–æ—Ä–æ–º —Ü–≤–µ—Ç–∞
function showColorModal() {
    document.getElementById('teamNameModal').style.display = 'none';
    document.getElementById('colorModal').style.display = 'flex';
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ –∫–æ –≤—Å–µ–π –∫–æ–º–∞–Ω–¥–µ
function applyTeamColor(color) {
    teamColor = color;
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç –∫–æ –≤—Å–µ–º –∏–≥—Ä–æ–∫–∞–º –∫–æ–º–∞–Ω–¥—ã
    if (gameState.playerTeam === 'red') {
        // –î–ª—è –∫—Ä–∞—Å–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
        player.color = color;
        redBots.forEach(bot => {
            bot.color = color;
        });
        // –°–∏–Ω—è—è –∫–æ–º–∞–Ω–¥–∞ –æ—Å—Ç–∞–µ—Ç—Å—è —Å —Ü–≤–µ—Ç–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        blueBots.forEach(bot => {
            bot.color = '#3742fa'; // –°–∏–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        });
    } else {
        // –î–ª—è —Å–∏–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã
        player.color = color;
        blueBots.forEach(bot => {
            bot.color = color;
        });
        // –ö—Ä–∞—Å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –æ—Å—Ç–∞–µ—Ç—Å—è —Å —Ü–≤–µ—Ç–æ–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        redBots.forEach(bot => {
            bot.color = '#ff4757'; // –ö—Ä–∞—Å–Ω—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        });
    }
    
    console.log(`–¶–≤–µ—Ç –∫–æ–º–∞–Ω–¥—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: ${color}`);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∏–≥—Ä–æ–∫–æ–≤ —Å —É—á–µ—Ç–æ–º —Ü–≤–µ—Ç–∞
function drawPlayerWithColor() {
    // –û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç –∏–≥—Ä–æ–∫–∞
    ctx.fillStyle = player.color || (gameState.playerTeam === 'red' ? '#ff4757' : '#3742fa');
    ctx.beginPath();
    ctx.arc(player.x, player.y, config.playerRadius, 0, Math.PI * 2);
    ctx.fill();

    // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π...
    ctx.strokeStyle = '#00ff00';
    ctx.lineWidth = 3;
    ctx.stroke();

    const triangleSize = 12;
    const triangleYOffset = -config.playerRadius - 18;
    
    ctx.fillStyle = 'rgba(0, 255, 0, 0.7)';
    ctx.beginPath();
    ctx.moveTo(player.x, player.y + triangleYOffset);
    ctx.lineTo(player.x - triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.lineTo(player.x + triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.closePath();
    ctx.fill();

    ctx.strokeStyle = '#00ff00';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(player.x, player.y + triangleYOffset);
    ctx.lineTo(player.x - triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.lineTo(player.x + triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.closePath();
    ctx.stroke();

    ctx.shadowColor = 'rgba(0, 255, 0, 0.7)';
    ctx.shadowBlur = 15;
    ctx.beginPath();
    ctx.arc(player.x, player.y, config.playerRadius + 2, 0, Math.PI * 2);
    ctx.stroke();
    ctx.shadowBlur = 0;

    if (player.kickCooldown > 0) {
        ctx.strokeStyle = 'rgba(255, 215, 0, 0.8)';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.arc(player.x, player.y, config.playerRadius + 12, 0, Math.PI * 2);
        ctx.stroke();
        
        ctx.shadowColor = 'rgba(255, 215, 0, 0.6)';
        ctx.shadowBlur = 20;
        ctx.beginPath();
        ctx.arc(player.x, player.y, config.playerRadius + 10, 0, Math.PI * 2);
        ctx.stroke();
        ctx.shadowBlur = 0;
    }

    if (player.hasBall) {
        ctx.strokeStyle = 'rgba(255, 255, 0, 0.7)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(player.x, player.y, config.ballControlDistance, 0, Math.PI * 2);
        ctx.stroke();
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –±–æ—Ç–æ–≤ —Å —É—á–µ—Ç–æ–º —Ü–≤–µ—Ç–∞
function drawBotsWithColor() {
    // –†–∏—Å—É–µ–º –∫—Ä–∞—Å–Ω—ã—Ö –±–æ—Ç–æ–≤
    redBots.forEach(bot => {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–º –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–º
        if (gameState.tournament.active && bot.team !== gameState.playerTeam) {
            const opponentColors = gameState.tournament.opponentTeam.colors;
            drawTwoColorPlayer(bot.x, bot.y, config.playerRadius, opponentColors[0], opponentColors[1]);
        } else {
            // –û–±—ã—á–Ω—ã–π –æ–¥–Ω–æ—Ü–≤–µ—Ç–Ω—ã–π –±–æ—Ç
            ctx.fillStyle = bot.color || '#ff4757';
            ctx.beginPath();
            ctx.arc(bot.x, bot.y, config.playerRadius, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // –û–±–≤–æ–¥–∫–∞ –ø–æ —Ä–æ–ª–∏
        ctx.strokeStyle = bot.role === 'goalkeeper' ? 'gold' : 
                         bot.role === 'defender' ? 'cyan' : 'lime';
        ctx.lineWidth = 2;
        ctx.stroke();
    });
    
    // –†–∏—Å—É–µ–º —Å–∏–Ω–∏—Ö –±–æ—Ç–æ–≤
    blueBots.forEach(bot => {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–º –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–º
        if (gameState.tournament.active && bot.team !== gameState.playerTeam) {
            const opponentColors = gameState.tournament.opponentTeam.colors;
            drawTwoColorPlayer(bot.x, bot.y, config.playerRadius, opponentColors[0], opponentColors[1]);
        } else {
            // –û–±—ã—á–Ω—ã–π –æ–¥–Ω–æ—Ü–≤–µ—Ç–Ω—ã–π –±–æ—Ç
            ctx.fillStyle = bot.color || '#3742fa';
            ctx.beginPath();
            ctx.arc(bot.x, bot.y, config.playerRadius, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // –û–±–≤–æ–¥–∫–∞ –ø–æ —Ä–æ–ª–∏
        ctx.strokeStyle = bot.role === 'goalkeeper' ? 'gold' : 
                         bot.role === 'defender' ? 'cyan' : 'lime';
        ctx.lineWidth = 2;
        ctx.stroke();
    });
}

function checkAndStartOvertime() {
    if (gameState.timeLeft <= 0 && !gameState.isOvertime && gameState.redScore === gameState.blueScore) {
        gameState.isOvertime = true;
        gameState.isGoldenGoal = true;
        gameState.overtimeStarted = true;
        
        // –°–∫—Ä—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–¥–ø–∏—Å—å "–î–û –ó–ì"
        timerElem.style.display = 'none';
        
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –Ω–∞–¥–ø–∏—Å–∏ "–î–û –ó–ì" –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
        if (!document.getElementById('goldenGoalText')) {
            const goldenGoalText = document.createElement('div');
            goldenGoalText.id = 'goldenGoalText';
            goldenGoalText.textContent = '–î–û –ó–ì';
            goldenGoalText.style.position = 'absolute';
            goldenGoalText.style.top = '30px';
            goldenGoalText.style.left = '50%';
            goldenGoalText.style.transform = 'translateX(-50%)';
            goldenGoalText.style.fontSize = '36px';
            goldenGoalText.style.fontWeight = 'bold';
            goldenGoalText.style.color = 'gold';
            goldenGoalText.style.textShadow = '0 0 10px rgba(255, 215, 0, 0.8)';
            goldenGoalText.style.zIndex = '15';
            document.querySelector('.ui-overlay').appendChild(goldenGoalText);
        } else {
            document.getElementById('goldenGoalText').style.display = 'block';
        }
        
        console.log("–û–≤–µ—Ä—Ç–∞–π–º –Ω–∞—á–∞–ª—Å—è! –î–û –ó–û–õ–û–¢–û–ì–û –ì–û–õ–ê!");
    }
}

        function resetPositions() {
    player.x = gameState.playerTeam === 'red' ? config.width / 4 : config.width * 3 / 4;
    player.y = config.height / 2;
    player.vx = player.vy = 0;
    player.hasBall = false;
    
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—é –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è
    teleportBallToCenter();
    
    // –°–±—Ä–æ—Å –ø–æ–∑–∏—Ü–∏–π –±–æ—Ç–æ–≤
    initBots();
    
    gameState.goalJustScored = false;
    gameState.goalCooldown = config.goalCooldown;
}

function teleportBallToCenter() {
    ball.x = config.width / 2;
    ball.y = config.height / 2;
    ball.vx = 0;
    ball.vy = 0;
    
    // –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–∞ AFK
    gameState.ballLastMoveTime = Date.now();
    gameState.ballLastX = ball.x;
    gameState.ballLastY = ball.y;
    
    console.log("–ú—è—á —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ —Ü–µ–Ω—Ç—Ä –∏–∑-–∑–∞ –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è");
}


function initBots() {
    redBots = [];
    blueBots = [];
    
    // –°–æ–∑–¥–∞–µ–º –±–æ—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
    if (gameState.playerTeam === 'red') {
        // –£ –∫—Ä–∞—Å–Ω—ã—Ö 2 –±–æ—Ç–∞ (–∏–≥—Ä–æ–∫ + 2 –±–æ—Ç–∞ = 3)
        redBots = [
            createBot('red', 'goalkeeper'),
            createBot('red', 'attacker')
        ];
        // –£ —Å–∏–Ω–∏—Ö 3 –±–æ—Ç–∞
        blueBots = [
            createBot('blue', 'goalkeeper'),
            createBot('blue', 'defender'),
            createBot('blue', 'attacker')
        ];
    } else {
        // –£ —Å–∏–Ω–∏—Ö 2 –±–æ—Ç–∞ (–∏–≥—Ä–æ–∫ + 2 –±–æ—Ç–∞ = 3)
        blueBots = [
            createBot('blue', 'goalkeeper'),
            createBot('blue', 'attacker')
        ];
        // –£ –∫—Ä–∞—Å–Ω—ã—Ö 3 –±–æ—Ç–∞
        redBots = [
            createBot('red', 'goalkeeper'),
            createBot('red', 'defender'),
            createBot('red', 'attacker')
        ];
    }
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç –∫ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥–µ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–æ–≤
    if (teamColor) {
        applyTeamColor(teamColor);
    }
    
    // –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–∞—Ö –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    console.log("–°–æ–∑–¥–∞–Ω—ã –±–æ—Ç—ã:");
    redBots.forEach((bot, index) => {
        console.log(`–ö—Ä–∞—Å–Ω—ã–π –±–æ—Ç ${index + 1}: ${bot.isOpponent ? '–°–æ–ø–µ—Ä–Ω–∏–∫' : '–°–æ—é–∑–Ω–∏–∫'}, —Å–∫–æ—Ä–æ—Å—Ç—å: ${bot.speed}`);
    });
    blueBots.forEach((bot, index) => {
        console.log(`–°–∏–Ω–∏–π –±–æ—Ç ${index + 1}: ${bot.isOpponent ? '–°–æ–ø–µ—Ä–Ω–∏–∫' : '–°–æ—é–∑–Ω–∏–∫'}, —Å–∫–æ—Ä–æ—Å—Ç—å: ${bot.speed}`);
    });
}

// –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞
function createBot(team, role) {
    const baseX = team === 'red' ? config.width / 4 : config.width * 3 / 4;
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ—Ç –±–æ—Ç —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–º
    const isOpponent = (team === 'red' && gameState.playerTeam === 'blue') || 
                      (team === 'blue' && gameState.playerTeam === 'red');
    
    // –î–ª—è —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤ –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –¥–ª—è —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã - –±–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    const difficulty = isOpponent ? getCurrentDifficulty() : difficultyLevels[0];
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ü–≤–µ—Ç –±–æ—Ç–∞
    let botColor;
    if (team === 'red') {
        botColor = (gameState.playerTeam === 'red' && teamColor) ? teamColor : '#ff4757';
    } else {
        botColor = (gameState.playerTeam === 'blue' && teamColor) ? teamColor : '#3742fa';
    }
    
    return {
        x: baseX,
        y: config.height / 2,
        vx: 0,
        vy: 0,
        team: team,
        role: role,
        kickCooldown: 0,
        hasBall: false,
        targetX: 0,
        targetY: 0,
        state: 'positioning',
        color: botColor,
        isOpponent: isOpponent, // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–ª–∞–≥ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–º
        // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞–º
        speed: botConfig.speed * difficulty.speedMultiplier,
        kickPower: botConfig.kickPower * difficulty.kickPowerMultiplier,
        reactionTime: botConfig.reactionTime / difficulty.reactionMultiplier,
        errorChance: difficulty.errorChance,
        passAccuracy: difficulty.passAccuracy
    };
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –±–æ—Ç–æ–≤
function updateBots() {
    updateBotTeam(redBots);
    updateBotTeam(blueBots);
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–≤—É–∫–æ–≤
function playKickSound() {
    const kickSound = document.getElementById('kickSound');
    kickSound.currentTime = 0; // –ü–µ—Ä–µ–º–æ—Ç–∞—Ç—å –≤ –Ω–∞—á–∞–ª–æ
    kickSound.play().catch(e => console.log("Audio play error:", e));
}

function playGoalSound() {
    const goalSound = document.getElementById('goalSound');
    goalSound.currentTime = 0; // –ü–µ—Ä–µ–º–æ—Ç–∞—Ç—å –≤ –Ω–∞—á–∞–ª–æ
    goalSound.play().catch(e => console.log("Audio play error:", e));
}

function callForPass() {
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–æ–∫–æ–º–∞–Ω–¥–Ω–∏–∫–∞–º–∏ –∏–≥—Ä–æ–∫–∞
    let teammates;
    if (gameState.playerTeam === 'red') {
        teammates = redBots;
    } else {
        teammates = blueBots;
    }

    let bestPasser = null;
    let shortestDistance = Infinity;

    // –ò—â–µ–º –±–ª–∏–∂–∞–π—à–µ–≥–æ —Å–æ–∫–æ–º–∞–Ω–¥–Ω–∏–∫–∞, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å –º—è—á
    teammates.forEach(bot => {
        if (bot.hasBall) {
            const distToPlayer = Math.sqrt((bot.x - player.x) ** 2 + (bot.y - player.y) ** 2);
            
            if (distToPlayer < shortestDistance) {
                shortestDistance = distToPlayer;
                bestPasser = bot;
            }
        }
    });

    // –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø–∞—Å—É—é—â–µ–≥–æ
    if (bestPasser) {
        // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Å–∞ –ø—Ä—è–º–æ –Ω–∞ –∏–≥—Ä–æ–∫–∞
        const passAngle = Math.atan2(player.y - ball.y, player.x - ball.x);
        const power = 8.5; // –ß–µ—Ç–∫–∏–π —Ä–µ–∑–∫–∏–π –ø–∞—Å

        // –ó–∞–¥–∞–µ–º –Ω–æ–≤—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –º—è—á—É
        ball.vx = Math.cos(passAngle) * power;
        ball.vy = Math.sin(passAngle) * power;

        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—É–ª–¥–∞—É–Ω —É–¥–∞—Ä–∞ —É –±–æ—Ç–∞
        bestPasser.kickCooldown = 30;
        
        // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –≤—ã–∑–æ–≤–∞ –ø–∞—Å–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        showPassCallEffect(player.x, player.y);
        
        return true;
    }
    
    return false;
}

// –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è –≤—ã–∑–æ–≤–∞ –ø–∞—Å–∞ (–∫—Ä—É–≥ –≤–æ–∫—Ä—É–≥ –∏–≥—Ä–æ–∫–∞)
function showPassCallEffect(x, y) {
    ctx.strokeStyle = '#00ff00';
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.arc(x, y, 25, 0, Math.PI * 2);
    ctx.stroke();
    
    ctx.strokeStyle = 'rgba(0, 255, 0, 0.5)';
    ctx.lineWidth = 6;
    ctx.beginPath();
    ctx.arc(x, y, 30, 0, Math.PI * 2);
    ctx.stroke();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–æ–≤
function updateBotTeam(bots) {
    bots.forEach(bot => {
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞
        determineBotState(bot);
        
        // –î–≤–∏–∂–µ–Ω–∏–µ –∫ —Ü–µ–ª–∏
        moveBotToTarget(bot);
        
        // –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –º—è—á–æ–º
        handleBotBallInteraction(bot);
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç—Ä–µ–Ω–∏–µ
        bot.vx *= 0.9;
        bot.vy *= 0.9;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é
        bot.x += bot.vx;
        bot.y += bot.vy;
        
        // –ì—Ä–∞–Ω–∏—Ü—ã –ø–æ–ª—è
        bot.x = Math.max(config.playerRadius, Math.min(config.width - config.playerRadius, bot.x));
        bot.y = Math.max(config.playerRadius, Math.min(config.height - config.playerRadius, bot.y));
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫—É–ª–¥–∞—É–Ω
        if (bot.kickCooldown > 0) bot.kickCooldown--;
    });
}

// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–∞
function determineBotState(bot) {
    const distToBall = Math.sqrt((ball.x - bot.x) ** 2 + (ball.y - bot.y) ** 2);
    const ballInMyHalf = (bot.team === 'red' && ball.x < config.width / 2) || 
                         (bot.team === 'blue' && ball.x > config.width / 2);
    
    switch (bot.role) {
        case 'goalkeeper':
            // –í—Ä–∞—Ç–∞—Ä—å –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –≤ —Å—Ç–æ—Ä–æ–Ω—É —Å–≤–æ–∏—Ö –≤–æ—Ä–æ—Ç
            const goalX = bot.team === 'red' ? 0 : config.width;
            const goalY = config.height / 2;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–æ–Ω—É –¥–≤–∏–∂–µ–Ω–∏—è –≤—Ä–∞—Ç–∞—Ä—è (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è –ø–µ—Ä–µ–¥ –≤–æ—Ä–æ—Ç–∞–º–∏)
            const keeperZoneX = bot.team === 'red' ? 80 : config.width - 80;
            const keeperZoneMinX = bot.team === 'red' ? 40 : config.width - 120;
            const keeperZoneMaxX = bot.team === 'red' ? 120 : config.width - 40;
            
            // –ï—Å–ª–∏ –º—è—á –Ω–∞ –Ω–∞—à–µ–π –ø–æ–ª–æ–≤–∏–Ω–µ - –ø—Ä–µ—Å–ª–µ–¥—É–µ–º –µ–≥–æ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
            if (ballInMyHalf) {
                bot.targetX = Math.max(keeperZoneMinX, Math.min(keeperZoneMaxX, ball.x));
                bot.targetY = ball.y;
                bot.state = 'chasing';
            } else {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –ø–æ–∑–∏—Ü–∏—é –ø–µ—Ä–µ–¥ –≤–æ—Ä–æ—Ç–∞–º–∏
                bot.targetX = keeperZoneX;
                bot.targetY = goalY;
                bot.state = 'positioning';
            }
            break;
            
        case 'defender':
            // –ó–∞—â–∏—Ç–Ω–∏–∫ –∏–≥—Ä–∞–µ—Ç –Ω–∞ —Å–≤–æ–µ–π –ø–æ–ª–æ–≤–∏–Ω–µ
            bot.targetX = bot.team === 'red' ? config.width / 3 : config.width * 2 / 3;
            bot.targetY = ball.y;
            bot.state = ballInMyHalf ? 'chasing' : 'positioning';
            break;
            
        case 'attacker':
            // –ù–∞–ø–∞–¥–∞—é—â–∏–π –∞—Ç–∞–∫—É–µ—Ç
            if (distToBall < 150) {
                bot.state = 'chasing';
                bot.targetX = ball.x;
                bot.targetY = ball.y;
            } else {
                bot.state = 'attacking';
                // –ó–∞–Ω–∏–º–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –¥–ª—è –∞—Ç–∞–∫–∏
                bot.targetX = bot.team === 'red' ? config.width * 2 / 3 : config.width / 3;
                bot.targetY = Math.random() * config.height;
            }
            break;
    }
}

// –î–≤–∏–∂–µ–Ω–∏–µ –±–æ—Ç–∞ –∫ —Ü–µ–ª–∏
function moveBotToTarget(bot) {
    const dx = bot.targetX - bot.x;
    const dy = bot.targetY - bot.y;
    const dist = Math.sqrt(dx * dx + dy * dy);
    
    if (dist > 10) {
        const speed = bot.speed * (bot.state === 'chasing' ? 1.2 : 0.8);
        bot.vx += (dx / dist) * speed * 0.1;
        bot.vy += (dy / dist) * speed * 0.1;
    }
}

// –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –±–æ—Ç–∞ —Å –º—è—á–æ–º
function handleBotBallInteraction(bot) {
    const dist = Math.sqrt((ball.x - bot.x) ** 2 + (ball.y - bot.y) ** 2);
    const minDist = config.playerRadius + config.ballRadius;
    
    bot.hasBall = dist < config.ballControlDistance + 10;
    
    if (dist < minDist) {
        const angle = Math.atan2(ball.y - bot.y, ball.x - bot.x);
        const overlap = minDist - dist;
        
        // –°–¥–≤–∏–≥–∞–µ–º –º—è—á
        ball.x += Math.cos(angle) * overlap;
        ball.y += Math.sin(angle) * overlap;
        
        // –ë–æ—Ç—ã –ª—É—á—à–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç –º—è—á (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è)
        if (bot.kickCooldown <= 0) {
            const controlStrength = botConfig.ballControl * (1 - bot.errorChance / 2);
            ball.vx += (bot.vx - ball.vx) * controlStrength;
            ball.vy += (bot.vy - ball.vy) * controlStrength;
        }
        
        // –£–¥–∞—Ä –ø–æ –º—è—á—É —Å —É—á–µ—Ç–æ–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        if (bot.kickCooldown <= 0 && Math.random() < (0.3 + (1 - bot.errorChance) * 0.4)) {
            let targetX, targetY;
            
            if (bot.role === 'goalkeeper') {
                // –í—Ä–∞—Ç–∞—Ä—å –æ—Ç–¥–∞–µ—Ç –ø–∞—Å –∑–∞—â–∏—Ç–Ω–∏–∫—É –∏–ª–∏ –Ω–∞–ø–∞–¥–∞—é—â–µ–º—É
                const teammates = bot.team === 'red' ? redBots : blueBots;
                const availableTeammates = teammates.filter(t => t.role !== 'goalkeeper');
                if (availableTeammates.length > 0) {
                    const target = availableTeammates[Math.floor(Math.random() * availableTeammates.length)];
                    targetX = target.x;
                    targetY = target.y;
                } else {
                    targetX = config.width / 2;
                    targetY = config.height / 2;
                }
            } else {
                // –ê—Ç–∞–∫–∞ –∏–ª–∏ –ø–∞—Å —Å —É—á–µ—Ç–æ–º —Ç–æ—á–Ω–æ—Å—Ç–∏
                if (Math.random() < (0.7 - bot.errorChance * 0.3) && bot.role === 'attacker') {
                    // –ê—Ç–∞–∫–∞ –Ω–∞ –≤–æ—Ä–æ—Ç–∞ (–±–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è —É —Å–∏–ª—å–Ω—ã—Ö –±–æ—Ç–æ–≤)
                    targetX = bot.team === 'red' ? config.width - 50 : 50;
                    targetY = config.height / 2 + (Math.random() - 0.5) * (100 - bot.passAccuracy * 30);
                } else {
                    // –ü–∞—Å –ø–∞—Ä—Ç–Ω–µ—Ä—É (–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —É —Å–∏–ª—å–Ω—ã—Ö –±–æ—Ç–æ–≤)
                    const teammates = bot.team === 'red' ? [...redBots, player.team === 'red' ? player : null] : 
                                                            [...blueBots, player.team === 'blue' ? player : null];
                    const validTeammates = teammates.filter(t => t && t !== bot);
                    if (validTeammates.length > 0) {
                        const target = validTeammates[Math.floor(Math.random() * validTeammates.length)];
                        // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏
                        targetX = target.x + (Math.random() - 0.5) * (50 - bot.passAccuracy * 40);
                        targetY = target.y + (Math.random() - 0.5) * (50 - bot.passAccuracy * 40);
                    } else {
                        targetX = config.width / 2;
                        targetY = config.height / 2;
                    }
                }
            }
            
            const kickAngle = Math.atan2(targetY - ball.y, targetX - ball.x);
            const power = bot.kickPower;
            ball.vx += Math.cos(kickAngle) * power;
            ball.vy += Math.sin(kickAngle) * power;
            bot.kickCooldown = 11 / bot.reactionTime;
            playKickSound();
        }
    }
}

// –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –±–æ—Ç–æ–≤
function drawBots() {
    // –†–∏—Å—É–µ–º –∫—Ä–∞—Å–Ω—ã—Ö –±–æ—Ç–æ–≤
    redBots.forEach(bot => {
        ctx.fillStyle = '#ff4757';
        ctx.beginPath();
        ctx.arc(bot.x, bot.y, config.playerRadius, 0, Math.PI * 2);
        ctx.fill();
        
        // –û–±–≤–æ–¥–∫–∞ –ø–æ —Ä–æ–ª–∏
        ctx.strokeStyle = bot.role === 'goalkeeper' ? 'gold' : 
                         bot.role === 'defender' ? 'cyan' : 'lime';
        ctx.lineWidth = 2;
        ctx.stroke();
    });
    
    // –†–∏—Å—É–µ–º —Å–∏–Ω–∏—Ö –±–æ—Ç–æ–≤
    blueBots.forEach(bot => {
        ctx.fillStyle = '#3742fa';
        ctx.beginPath();
        ctx.arc(bot.x, bot.y, config.playerRadius, 0, Math.PI * 2);
        ctx.fill();
        
        // –û–±–≤–æ–¥–∫–∞ –ø–æ —Ä–æ–ª–∏
        ctx.strokeStyle = bot.role === 'goalkeeper' ? 'gold' : 
                         bot.role === 'defender' ? 'cyan' : 'lime';
        ctx.lineWidth = 2;
        ctx.stroke();
    });
}


        function updatePlayer() {
    // –î–≤–∏–∂–µ–Ω–∏–µ
    let dx = 0, dy = 0;
    if (keys.w) dy -= 1;
    if (keys.s) dy += 1;
    if (keys.a) dx -= 1;
    if (keys.d) dx += 1;
    
    // –í—ã–∑–æ–≤ –ø–∞—Å–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Q
    if (keys.q) {
        callForPass();
        keys.q = false; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    }

    // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    if (dx !== 0 && dy !== 0) {
        const len = Math.sqrt(dx * dx + dy * dy);
        dx /= len;
        dy /= len;
    }

    player.vx = dx * config.playerSpeed;
    player.vy = dy * config.playerSpeed;

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
    player.x += player.vx;
    player.y += player.vy;

    // –ì—Ä–∞–Ω–∏—Ü—ã –ø–æ–ª—è
    player.x = Math.max(config.playerRadius, Math.min(config.width - config.playerRadius, player.x));
    player.y = Math.max(config.playerRadius, Math.min(config.height - config.playerRadius, player.y));

    // –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –º—è—á–æ–º
    const dist = Math.sqrt((ball.x - player.x) ** 2 + (ball.y - player.y) ** 2);
    const minDist = config.playerRadius + config.ballRadius;
    
    // –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –º—è—á–∞ (–º–∞–≥–Ω–µ—Ç–∏–∑–º)
    player.hasBall = false;
    
    if (dist < minDist) {
        const angle = Math.atan2(ball.y - player.y, ball.x - player.x);
        const overlap = minDist - dist;
        
        // –°–¥–≤–∏–≥–∞–µ–º –º—è—á
        ball.x += Math.cos(angle) * overlap;
        ball.y += Math.sin(angle) * overlap;
        
        // –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Ñ–∏–∑–∏–∫–∞ - –º—è—á —Ç–æ–∂–µ —Ç–æ–ª–∫–∞–µ—Ç –∏–≥—Ä–æ–∫–∞
        const ballMass = 0.4; // –ú–∞—Å—Å–∞ –º—è—á–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏–≥—Ä–æ–∫–∞
        player.x -= Math.cos(angle) * overlap * ballMass;
        player.y -= Math.sin(angle) * overlap * ballMass;
        
        // –ü–µ—Ä–µ–¥–∞—á–∞ –∏–º–ø—É–ª—å—Å–∞ –æ—Ç –º—è—á–∞ –∫ –∏–≥—Ä–æ–∫—É
        const impactStrength = 0.2; // –°–∏–ª–∞ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è –º—è—á–∞ –Ω–∞ –∏–≥—Ä–æ–∫–∞
        player.vx += ball.vx * impactStrength;
        player.vy += ball.vy * impactStrength;
        
        // –£–ë–†–ê–ù –º–∞–≥–Ω–µ—Ç–∏–∑–º - –º—è—á –Ω–µ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∏–≥—Ä–æ–∫–æ–º
        // –û—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ
    }

    // –£–¥–∞—Ä
if (keys.space && player.kickCooldown <= 0) {
    if (dist < minDist + 10) {
        const angle = Math.atan2(ball.y - player.y, ball.x - player.x);
        const power = config.kickPower;
        ball.vx += Math.cos(angle) * power;
        ball.vy += Math.sin(angle) * power;
        player.kickCooldown = 7;
        playKickSound(); // –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É —Å—Ç—Ä–æ–∫—É
    }
}

    if (player.kickCooldown > 0) player.kickCooldown--;
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –ø–æ—Å–ª–µ –≥–æ–ª–∞
    if (gameState.goalCooldown > 0) {
        gameState.goalCooldown--;
    }
}
function updateBall() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è –º—è—á–∞
    const currentTime = Date.now();
    const movedX = Math.abs(ball.x - gameState.ballLastX) > 0.5;
    const movedY = Math.abs(ball.y - gameState.ballLastY) > 0.5;
    
    if (movedX || movedY) {
        // –ú—è—á –¥–≤–∏–≥–∞–ª—Å—è - –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∏ –ø–æ–∑–∏—Ü–∏—é
        gameState.ballLastMoveTime = currentTime;
        gameState.ballLastX = ball.x;
        gameState.ballLastY = ball.y;
    } else if (currentTime - gameState.ballLastMoveTime > config.ballAfkThreshold) {
        // –ú—è—á –Ω–µ –¥–≤–∏–≥–∞–ª—Å—è –¥–æ–ª—å—à–µ –ø–æ—Ä–æ–≥–∞ - —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ —Ü–µ–Ω—Ç—Ä
        teleportBallToCenter();
    }
    
    // –î–≤–∏–∂–µ–Ω–∏–µ –º—è—á–∞
    ball.x += ball.vx;
    ball.y += ball.vy;

    // –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ –º—è—á–∞ —Å —É—á–µ—Ç–æ–º –≤—Ä–µ–º–µ–Ω–∏
    const currentSpeed = Math.sqrt(ball.vx * ball.vx + ball.vy * ball.vy);
    
    if (currentSpeed > 0.1) {
        // –ë–∞–∑–æ–≤–æ–µ —Ç—Ä–µ–Ω–∏–µ (–≤–æ–∑–¥—É—à–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ)
        const airResistance = 0.99;
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ç—Ä–µ–Ω–∏–µ –æ—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (—á–µ–º –±—ã—Å—Ç—Ä–µ–µ –º—è—á, —Ç–µ–º –±–æ–ª—å—à–µ —Ç—Ä–µ–Ω–∏–µ)
        const surfaceFriction = 0.995 - (currentSpeed * 0.0001);
        
        // –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–º–µ–¥–ª–µ–Ω–∏—è
        const combinedFriction = airResistance * surfaceFriction;
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ
        ball.vx *= combinedFriction;
        ball.vy *= combinedFriction;
        
        // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—á—Ç–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é
        if (Math.abs(ball.vx) < 0.05) ball.vx = 0;
        if (Math.abs(ball.vy) < 0.05) ball.vy = 0;
    } else {
        // –ü–æ–ª–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
        ball.vx = 0;
        ball.vy = 0;
    }

    // –û—Ç—Å–∫–æ–∫ –æ—Ç —Å—Ç–µ–Ω (–∫—Ä–æ–º–µ –∑–æ–Ω—ã –≤–æ—Ä–æ—Ç)
    if (ball.y - config.ballRadius < 0 || ball.y + config.ballRadius > config.height) {
        ball.vy = -ball.vy * 0.9;
        ball.y = Math.max(config.ballRadius, Math.min(config.height - config.ballRadius, ball.y));
    }
    
    // –û—Ç—Å–∫–æ–∫ –æ—Ç –±–æ–∫–æ–≤—ã—Ö —Å—Ç–µ–Ω (—Ç–æ–ª—å–∫–æ –≤–Ω–µ –∑–æ–Ω—ã –≤–æ—Ä–æ—Ç)
    const goalTop = (config.height - config.goalHeight) / 2;
    const goalBottom = (config.height + config.goalHeight) / 2;
    
    // –õ–µ–≤–∞—è —Å—Ç–µ–Ω–∞ (–∫—Ä–æ–º–µ –≤–æ—Ä–æ—Ç)
    if (ball.x - config.ballRadius < 0) {
        if (ball.y < goalTop || ball.y > goalBottom) {
            ball.vx = -ball.vx * 0.9;
            ball.x = config.ballRadius;
        }
    }
    
    // –ü—Ä–∞–≤–∞—è —Å—Ç–µ–Ω–∞ (–∫—Ä–æ–º–µ –≤–æ—Ä–æ—Ç)
    if (ball.x + config.ballRadius > config.width) {
        if (ball.y < goalTop || ball.y > goalBottom) {
            ball.vx = -ball.vx * 0.9;
            ball.x = config.width - config.ballRadius;
        }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ–ª–æ–≤ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –±—ã–ª–æ –Ω–µ–¥–∞–≤–Ω–æ –≥–æ–ª–∞)
    if (gameState.goalCooldown <= 0) {
        checkGoals();
    }
}

function checkPlayerBotCollisions() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π –∏–≥—Ä–æ–∫–∞ —Å –±–æ—Ç–∞–º–∏
    const allBots = [...redBots, ...blueBots];
    
    allBots.forEach(bot => {
        const dist = Math.sqrt((player.x - bot.x) ** 2 + (player.y - bot.y) ** 2);
        const minDist = config.playerRadius * 2;
        
        if (dist < minDist) {
            const angle = Math.atan2(player.y - bot.y, player.x - bot.x);
            const overlap = minDist - dist;
            
            // –°–¥–≤–∏–≥–∞–µ–º –æ–±–æ–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
            const moveRatio = 0.5; // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–ª—ã –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è
            
            player.x += Math.cos(angle) * overlap * moveRatio;
            player.y += Math.sin(angle) * overlap * moveRatio;
            
            bot.x -= Math.cos(angle) * overlap * moveRatio;
            bot.y -= Math.sin(angle) * overlap * moveRatio;
            
            // –û–±–º–µ–Ω –∏–º–ø—É–ª—å—Å–∞–º–∏ (—Ñ–∏–∑–∏–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è)
            const playerMass = 1.0;
            const botMass = 0.8;
            const totalMass = playerMass + botMass;
            
            const playerVx = player.vx;
            const playerVy = player.vy;
            const botVx = bot.vx;
            const botVy = bot.vy;
            
            // –ù–æ–≤—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ—Å–ª–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            player.vx = (playerVx * (playerMass - botMass) + 2 * botMass * botVx) / totalMass * 0.7;
            player.vy = (playerVy * (playerMass - botMass) + 2 * botMass * botVy) / totalMass * 0.7;
            
            bot.vx = (botVx * (botMass - playerMass) + 2 * playerMass * playerVx) / totalMass * 0.7;
            bot.vy = (botVy * (botMass - playerMass) + 2 * playerMass * playerVy) / totalMass * 0.7;
        }
    });
}

function checkBotBotCollisions() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
    checkTeamBotCollisions(redBots);
    checkTeamBotCollisions(blueBots);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
    redBots.forEach(redBot => {
        blueBots.forEach(blueBot => {
            const dist = Math.sqrt((redBot.x - blueBot.x) ** 2 + (redBot.y - blueBot.y) ** 2);
            const minDist = config.playerRadius * 2;
            
            if (dist < minDist) {
                const angle = Math.atan2(redBot.y - blueBot.y, redBot.x - blueBot.x);
                const overlap = minDist - dist;
                
                // –°–¥–≤–∏–≥–∞–µ–º –æ–±–æ–∏—Ö –±–æ—Ç–æ–≤
                const moveRatio = 0.5;
                
                redBot.x += Math.cos(angle) * overlap * moveRatio;
                redBot.y += Math.sin(angle) * overlap * moveRatio;
                
                blueBot.x -= Math.cos(angle) * overlap * moveRatio;
                blueBot.y -= Math.sin(angle) * overlap * moveRatio;
                
                // –û–±–º–µ–Ω –∏–º–ø—É–ª—å—Å–∞–º–∏
                const redMass = 0.8;
                const blueMass = 0.8;
                const totalMass = redMass + blueMass;
                
                const redVx = redBot.vx;
                const redVy = redBot.vy;
                const blueVx = blueBot.vx;
                const blueVy = blueBot.vy;
                
                redBot.vx = (redVx * (redMass - blueMass) + 2 * blueMass * blueVx) / totalMass * 0.7;
                redBot.vy = (redVy * (redMass - blueMass) + 2 * blueMass * blueVy) / totalMass * 0.7;
                
                blueBot.vx = (blueVx * (blueMass - redMass) + 2 * redMass * redVx) / totalMass * 0.7;
                blueBot.vy = (blueVy * (blueMass - redMass) + 2 * redMass * redVy) / totalMass * 0.7;
            }
        });
    });
}

function checkTeamBotCollisions(bots) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π –º–µ–∂–¥—É –±–æ—Ç–∞–º–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã
    for (let i = 0; i < bots.length; i++) {
        for (let j = i + 1; j < bots.length; j++) {
            const bot1 = bots[i];
            const bot2 = bots[j];
            
            const dist = Math.sqrt((bot1.x - bot2.x) ** 2 + (bot1.y - bot2.y) ** 2);
            const minDist = config.playerRadius * 2;
            
            if (dist < minDist) {
                const angle = Math.atan2(bot1.y - bot2.y, bot1.x - bot2.x);
                const overlap = minDist - dist;
                
                // –°–¥–≤–∏–≥–∞–µ–º –æ–±–æ–∏—Ö –±–æ—Ç–æ–≤
                const moveRatio = 0.5;
                
                bot1.x += Math.cos(angle) * overlap * moveRatio;
                bot1.y += Math.sin(angle) * overlap * moveRatio;
                
                bot2.x -= Math.cos(angle) * overlap * moveRatio;
                bot2.y -= Math.sin(angle) * overlap * moveRatio;
                
                // –û–±–º–µ–Ω –∏–º–ø—É–ª—å—Å–∞–º–∏
                const mass1 = 0.8;
                const mass2 = 0.8;
                const totalMass = mass1 + mass2;
                
                const vx1 = bot1.vx;
                const vy1 = bot1.vy;
                const vx2 = bot2.vx;
                const vy2 = bot2.vy;
                
                bot1.vx = (vx1 * (mass1 - mass2) + 2 * mass2 * vx2) / totalMass * 0.7;
                bot1.vy = (vy1 * (mass1 - mass2) + 2 * mass2 * vy2) / totalMass * 0.7;
                
                bot2.vx = (vx2 * (mass2 - mass1) + 2 * mass1 * vx1) / totalMass * 0.7;
                bot2.vy = (vy2 * (mass2 - mass1) + 2 * mass1 * vy1) / totalMass * 0.7;
            }
        }
    }
}

        function checkGoals() {
    if (gameState.goalCooldown <= 0) {
        const goalTop = (config.height - config.goalHeight) / 2;
        const goalBottom = (config.height + config.goalHeight) / 2;
        
        // –õ–µ–≤—ã–µ –≤–æ—Ä–æ—Ç–∞
        if (ball.x + config.ballRadius < 0 && ball.y > goalTop && ball.y < goalBottom) {
            gameState.blueScore++;
            blueScoreElem.textContent = gameState.blueScore;
            showGoalAnimation();
            playGoalSound();
            gameState.goalJustScored = true;
            gameState.goalCooldown = config.goalCooldown;
            
            // –ï—Å–ª–∏ –≤ –æ–≤–µ—Ä—Ç–∞–π–º–µ - —Å—Ä–∞–∑—É –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –∏–≥—Ä—É
            if (gameState.isOvertime) {
                setTimeout(() => {
                    endGame(); // –ó–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É –ø–æ—Å–ª–µ –≥–æ–ª–∞ –≤ –æ–≤–µ—Ä—Ç–∞–π–º–µ
                }, 2000);
            } else {
                setTimeout(() => {
                    resetPositions();
                    initBots();
                }, 2000);
            }
        }
        
        // –ü—Ä–∞–≤—ã–µ –≤–æ—Ä–æ—Ç–∞
        if (ball.x - config.ballRadius > config.width && ball.y > goalTop && ball.y < goalBottom) {
            gameState.redScore++;
            redScoreElem.textContent = gameState.redScore;
            showGoalAnimation();
            playGoalSound();
            gameState.goalJustScored = true;
            gameState.goalCooldown = config.goalCooldown;
            
            // –ï—Å–ª–∏ –≤ –æ–≤–µ—Ä—Ç–∞–π–º–µ - —Å—Ä–∞–∑—É –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –∏–≥—Ä—É
            if (gameState.isOvertime) {
                setTimeout(() => {
                    endGame(); // –ó–∞–≤–µ—Ä—à–∞–µ–º –∏–≥—Ä—É –ø–æ—Å–ª–µ –≥–æ–ª–∞ –≤ –æ–≤–µ—Ä—Ç–∞–π–º–µ
                }, 2000);
            } else {
                setTimeout(() => {
                    resetPositions();
                    initBots();
                }, 2000);
            }
        }
    }
}

        function showGoalAnimation() {
            gameState.goalAnimation = true;
            gameState.animationTimer = 120;
            goalAnimationElem.style.animation = 'none';
            void goalAnimationElem.offsetWidth;
            goalAnimationElem.style.animation = 'goalPulse 2s ease-out';
        }

        function updateTimer() {
    if (gameState.timeLeft > 0) {
        gameState.timeLeft--;
        const minutes = Math.floor(gameState.timeLeft / 60);
        const seconds = gameState.timeLeft % 60;
        timerElem.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        
        if (gameState.timeLeft === 0) {
            checkAndStartOvertime(); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –Ω–∞—á–∏–Ω–∞–µ–º –æ–≤–µ—Ä—Ç–∞–π–º –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (!gameState.isOvertime) {
                endGame(); // –ó–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –∏–≥—Ä—É –µ—Å–ª–∏ –æ–≤–µ—Ä—Ç–∞–π–º –Ω–µ –Ω—É–∂–µ–Ω
            }
        }
    }
}

        function endGame() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –Ω–∞—á–∏–Ω–∞—Ç—å –æ–≤–µ—Ä—Ç–∞–π–º
    if (gameState.timeLeft <= 0 && gameState.redScore === gameState.blueScore && !gameState.isOvertime) {
        checkAndStartOvertime();
        return; // –ù–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –∏–≥—Ä—É, –Ω–∞—á–∏–Ω–∞–µ–º –æ–≤–µ—Ä—Ç–∞–π–º
    }
    
    // –ï—Å–ª–∏ –æ–≤–µ—Ä—Ç–∞–π–º –∞–∫—Ç–∏–≤–µ–Ω –∏ –∑–∞–±–∏—Ç –≥–æ–ª, –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –∏–≥—Ä—É
    if (gameState.isOvertime && (gameState.redScore !== gameState.blueScore)) {
        gameState.running = false;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–π —Ä–µ–∂–∏–º
        if (gameState.tournament.active) {
            const isWin = (gameState.playerTeam === 'red' && gameState.redScore > gameState.blueScore) ||
                         (gameState.playerTeam === 'blue' && gameState.blueScore > gameState.redScore);
            
            handleMatchResult(isWin);
        } else {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ "–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!" —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï —Ç—É—Ä–Ω–∏—Ä–Ω—ã–π —Ä–µ–∂–∏–º
            finalScoreElem.textContent = `${gameState.redScore} - ${gameState.blueScore}`;
            gameOverElem.style.display = 'block';
        }
        
        return;
    }
    
    // –û–±—ã—á–Ω–æ–µ –æ–∫–æ–Ω—á–∞–Ω–∏–µ –∏–≥—Ä—ã (–±–µ–∑ –æ–≤–µ—Ä—Ç–∞–π–º–∞ –∏–ª–∏ –ø–æ—Å–ª–µ –æ–≤–µ—Ä—Ç–∞–π–º–∞ —Å –≥–æ–ª–æ–º)
    if (!gameState.isOvertime || (gameState.isOvertime && gameState.redScore !== gameState.blueScore)) {
        gameState.running = false;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ —Ç—É—Ä–Ω–∏—Ä–Ω—ã–π —Ä–µ–∂–∏–º
        if (gameState.tournament.active) {
            const isWin = (gameState.playerTeam === 'red' && gameState.redScore > gameState.blueScore) ||
                         (gameState.playerTeam === 'blue' && gameState.blueScore > gameState.redScore);
            
            handleMatchResult(isWin);
        } else {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ "–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!" —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï —Ç—É—Ä–Ω–∏—Ä–Ω—ã–π —Ä–µ–∂–∏–º
            finalScoreElem.textContent = `${gameState.redScore} - ${gameState.blueScore}`;
            gameOverElem.style.display = 'block';
        }
    }
}

        function drawField() {
            // –ü–æ–ª–µ
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(0, 0, config.width, config.height);

            // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(config.width / 2, 0);
            ctx.lineTo(config.width / 2, config.height);
            ctx.stroke();

            // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–≥
            ctx.beginPath();
            ctx.arc(config.width / 2, config.height / 2, 50, 0, Math.PI * 2);
            ctx.stroke();

            // –í–æ—Ä–æ—Ç–∞
            const goalTop = (config.height - config.goalHeight) / 2;
            const goalBottom = (config.height + config.goalHeight) / 2;
            
            // –õ–µ–≤—ã–µ –≤–æ—Ä–æ—Ç–∞
            ctx.strokeStyle = '#ff4757';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, goalTop);
            ctx.lineTo(0, goalBottom);
            ctx.stroke();
            
            // –ü—Ä–∞–≤—ã–µ –≤–æ—Ä–æ—Ç–∞
            ctx.strokeStyle = '#3742fa';
            ctx.beginPath();
            ctx.moveTo(config.width, goalTop);
            ctx.lineTo(config.width, goalBottom);
            ctx.stroke();
            
            // –°–µ—Ç–∫–∞ –≤–æ—Ä–æ—Ç
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.setLineDash([5, 5]);
            
            // –õ–µ–≤–∞—è —Å–µ—Ç–∫–∞
            ctx.beginPath();
            ctx.moveTo(0, goalTop);
            ctx.lineTo(-20, goalTop);
            ctx.moveTo(0, goalBottom);
            ctx.lineTo(-20, goalBottom);
            ctx.stroke();
            
            // –ü—Ä–∞–≤–∞—è —Å–µ—Ç–∫–∞
            ctx.beginPath();
            ctx.moveTo(config.width, goalTop);
            ctx.lineTo(config.width + 20, goalTop);
            ctx.moveTo(config.width, goalBottom);
            ctx.lineTo(config.width + 20, goalBottom);
            ctx.stroke();
            
            ctx.setLineDash([]);
        }

        function drawPlayer() {
    // –û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç –∏–≥—Ä–æ–∫–∞
    ctx.fillStyle = gameState.playerTeam === 'red' ? '#ff4757' : '#3742fa';
    ctx.beginPath();
    ctx.arc(player.x, player.y, config.playerRadius, 0, Math.PI * 2);
    ctx.fill();

    // –Ø—Ä–∫–∞—è –æ–±–≤–æ–¥–∫–∞ –∏–≥—Ä–æ–∫–∞ (—Ç–æ–ª—Å—Ç–∞—è –∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–∞—è)
    ctx.strokeStyle = '#00ff00'; // –Ø—Ä–∫–æ-–∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç
    ctx.lineWidth = 3;
    ctx.stroke();

    // –¢—Ä–µ—É–≥–æ–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–¥ –∏–≥—Ä–æ–∫–æ–º (–ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π)
    const triangleSize = 12;
    const triangleYOffset = -config.playerRadius - 18;
    
    ctx.fillStyle = 'rgba(0, 255, 0, 0.7)'; // –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –∑–µ–ª–µ–Ω—ã–π
    ctx.beginPath();
    ctx.moveTo(player.x, player.y + triangleYOffset);
    ctx.lineTo(player.x - triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.lineTo(player.x + triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.closePath();
    ctx.fill();

    // –û–±–≤–æ–¥–∫–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –¥–ª—è –ª—É—á—à–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
    ctx.strokeStyle = '#00ff00';
    ctx.lineWidth = 1.5;
    ctx.beginPath();
    ctx.moveTo(player.x, player.y + triangleYOffset);
    ctx.lineTo(player.x - triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.lineTo(player.x + triangleSize, player.y + triangleYOffset - triangleSize * 1.5);
    ctx.closePath();
    ctx.stroke();

    // –°–≤–µ—á–µ–Ω–∏–µ –≤–æ–∫—Ä—É–≥ –∏–≥—Ä–æ–∫–∞
    ctx.shadowColor = 'rgba(0, 255, 0, 0.7)';
    ctx.shadowBlur = 15;
    ctx.beginPath();
    ctx.arc(player.x, player.y, config.playerRadius + 2, 0, Math.PI * 2);
    ctx.stroke();
    ctx.shadowBlur = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–Ω—å

    // –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —É–¥–∞—Ä–∞
    if (player.kickCooldown > 0) {
        ctx.strokeStyle = 'rgba(255, 215, 0, 0.8)'; // –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.arc(player.x, player.y, config.playerRadius + 12, 0, Math.PI * 2); // –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ä–∞–¥–∏—É—Å
        ctx.stroke();
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –ø—Ä–∏ —É–¥–∞—Ä–µ
        ctx.shadowColor = 'rgba(255, 215, 0, 0.6)';
        ctx.shadowBlur = 20;
        ctx.beginPath();
        ctx.arc(player.x, player.y, config.playerRadius + 10, 0, Math.PI * 2);
        ctx.stroke();
        ctx.shadowBlur = 0;
    }

    // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—è –º—è—á–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    if (player.hasBall) {
        ctx.strokeStyle = 'rgba(255, 255, 0, 0.7)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(player.x, player.y, config.ballControlDistance, 0, Math.PI * 2);
        ctx.stroke();
    }
}

        function drawBall() {
            // –ú—è—á
            ctx.fillStyle = '#f1c40f';
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, config.ballRadius, 0, Math.PI * 2);
            ctx.fill();

            // –ß–µ—Ä–Ω—ã–µ –ø—è—Ç–∏—É–≥–æ–ª—å–Ω–∏–∫–∏
            ctx.fillStyle = '#000';
            for (let i = 0; i < 5; i++) {
                const angle = (i * Math.PI * 2 / 5) + Date.now() / 1000;
                const pentX = ball.x + Math.cos(angle) * config.ballRadius * 0.6;
                const pentY = ball.y + Math.sin(angle) * config.ballRadius * 0.6;
                ctx.beginPath();
                ctx.arc(pentX, pentY, config.ballRadius * 0.2, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function gameLoop() {
    if (!gameState.running) return;

    updatePlayer();
    updateBots();
    updateBall();
    
    checkPlayerBotCollisions();
    checkBotBotCollisions();

    drawField();
    drawPlayerWithColor(); // –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
    drawBotsWithColor();   // –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é
    drawBall();

    requestAnimationFrame(gameLoop);
}

        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        setInterval(() => {
            if (gameState.running) {
                updateTimer();
            }
        }, 1000);

        // –ù–∞—á–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
        drawField();

// –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–Ω–æ–ø–∫–∏ "–û–± –∏–≥—Ä–µ"
const aboutBtn = document.getElementById('aboutBtn');
const aboutModal = document.getElementById('aboutModal');
const overlay = document.getElementById('overlay');
const closeBtn = document.querySelector('.close-btn');

function openAboutModal() {
    aboutModal.style.display = 'block';
    overlay.style.display = 'block';
    gameState.running = false;
}

function closeAboutModal() {
    aboutModal.style.display = 'none';
    overlay.style.display = 'none';
    if (!teamMenu.style.display === 'block' && !gameOverElem.style.display === 'block') {
        gameState.running = true;
        gameLoop();
    }
}

aboutBtn.addEventListener('click', openAboutModal);
closeBtn.addEventListener('click', closeAboutModal);
overlay.addEventListener('click', closeAboutModal);

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ ESC
document.addEventListener('keydown', (e) => {
    if (e.code === 'Escape' && aboutModal.style.display === 'block') {
        closeAboutModal();
    }
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
document.getElementById('teamNameSubmit').addEventListener('click', () => {
    const teamNameInput = document.getElementById('teamNameInput');
    if (teamNameInput.value.trim()) {
        teamName = teamNameInput.value.trim();
        showColorModal();
    }
});

document.getElementById('teamNameInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        document.getElementById('teamNameSubmit').click();
    }
});

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ü–≤–µ—Ç–∞
document.querySelectorAll('.color-option').forEach(option => {
    option.addEventListener('click', () => {
        // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö options
        document.querySelectorAll('.color-option').forEach(opt => {
            opt.classList.remove('selected');
        });
        
        // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π option
        option.classList.add('selected');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ü–≤–µ—Ç
        const selectedColor = option.getAttribute('data-color');
        applyTeamColor(selectedColor);
    });
});

document.getElementById('colorSubmit').addEventListener('click', () => {
    document.getElementById('colorModal').style.display = 'none';
    teamMenu.style.display = 'block';
});

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
window.addEventListener('load', () => {
    setTimeout(showTeamNameModal, 500);
});
    </script>
</body>
</html>
